rule train_cdvae_jarvis:
    output:
        touch("sentinels/cdvae_benchmark_jarvis.trained")
    input:
        "sentinels/cdvae_env.created",
        "sentinels/jarvis_data.created"
    shell:
        """
        sbatch --wait job_runs/cdvae_benchmark_jarvis/train_cdvae.job
        """

rule infer_cdvae_jarvis:
    output:
        touch("sentinels/cdvae_benchmark_jarvis.inferred")
    input:
        "sentinels/cdvae_env.created",
        "sentinels/jarvis_data.created",
        "sentinels/cdvae_benchmark_jarvis.trained"
    shell:
        """
        sbatch --wait job_runs/cdvae_benchmark_jarvis/inference_cdvae.job
        """

rule benchmark_cdvae_jarvis:
    output:
        touch("sentinels/cdvae_benchmark_jarvis.final")
    input:
        "sentinels/cdvae_env.created",
        "sentinels/jarvis_data.created",
        "sentinels/cdvae_benchmark_jarvis.trained",
        "sentinels/cdvae_benchmark_jarvis.inferred"

    shell:
        """
        sbatch --wait job_runs/cdvae_benchmark_jarvis/benchmark_cdvae.job
        """
